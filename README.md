# Spring 입문 주차 개인 과제

간단한 게시판을 구현해서 CRUD 작동까지 해보기

## 변동사항
2022-12-06  
4주차 과제로 인해서 내용에 많은 변화가 생겨서 아래의 내용들은 이전 파일에 대한 주석 및 내용들
추후에 따로 파일을 빼서 추가할 예정

2022-12- 08  
4주차 과제 1로 인해서 추가적으로 변동사항이 생김 게시글 관련해서 로그인 및 회원가입 예외사항 및 정규식 추가
<br/>

## 요구사항


<details>
<summary>3주차 과제 요구사항</summary>
<div markdown="1">

1. 아래의 요구사항을 기반으로 Use Case 그려보기
    - 손으로 그려도 됩니다.
    - cf. [https://narup.tistory.com/70](https://narup.tistory.com/70)
2. 전체 게시글 목록 조회 API
    - 제목, 작성자명, 작성 내용, 작성 날짜를 조회하기
    - 작성 날짜 기준 내림차순으로 정렬하기
3. 게시글 작성 API
    - 제목, 작성자명, 비밀번호, 작성 내용을 저장하고
    - 저장된 게시글을 Client 로 반환하기
4. 선택한 게시글 조회 API
    - 선택한 게시글의 제목, 작성자명, 작성 날짜, 작성 내용을 조회하기 
    (검색 기능이 아닙니다. 간단한 게시글 조회만 구현해주세요.)
5. 선택한 게시글 수정 API
    - 수정을 요청할 때 수정할 데이터와 비밀번호를 같이 보내서 서버에서 비밀번호 일치 여부를 확인 한 후
    - 제목, 작성자명, 작성 내용을 수정하고 수정된 게시글을 Client 로 반환하기
6. 선택한 게시글 삭제 API
    - 삭제를 요청할 때 비밀번호를 같이 보내서 서버에서 비밀번호 일치 여부를 확인 한 후
    - 선택한 게시글을 삭제하고 Client 로 성공했다는 표시 반환하기

</div>
</details>


<details>
<summary>4주차 과제 1 요구사항</summary>
<div markdown="1">

1. 전체 게시글 목록 조회 API
   - 제목, 작성자명(username), 작성 내용, 작성 날짜를 조회하기
   - 작성 날짜 기준 내림차순으로 정렬하기
2. 게시글 작성 API
   - 토큰을 검사하여, 유효한 토큰일 경우에만 게시글 작성 가능
   - 제목, 작성자명(username), 작성 내용을 저장하고
   - 저장된 게시글을 Client 로 반환하기
3. 선택한 게시글 조회 API
   - 선택한 게시글의 제목, 작성자명(username), 작성 날짜, 작성 내용을 조회하기
     (검색 기능이 아닙니다. 간단한 게시글 조회만 구현해주세요.)
4. 선택한 게시글 수정 API
   - ~~수정을 요청할 때 수정할 데이터와 비밀번호를 같이 보내서 서버에서 비밀번호 일치 여부를 확인 한 후~~
   - 토큰을 검사한 후, 유효한 토큰이면서 해당 사용자가 작성한 게시글만 수정 가능
   - 제목, 작성 내용을 수정하고 수정된 게시글을 Client 로 반환하기
5. 선택한 게시글 삭제 API
   - ~~삭제를 요청할 때 비밀번호를 같이 보내서 서버에서 비밀번호 일치 여부를 확인 한 후~~
   - 토큰을 검사한 후, 유효한 토큰이면서 해당 사용자가 작성한 게시글만 삭제 가능
   - 선택한 게시글을 삭제하고 Client 로 성공했다는 메시지, 상태코드 반환하기

</div>
</details>

## API 명세서

<br/>


|    기능     | API URL     | Method | Request Header                                                                                                                                                                                               | Request                                                          | Response                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Response header                                     |
|:---------:|:------------|:-------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------|
|   회원가입    | /api/signup | POST   |                                                                                                                                                                                                              | {<br/>"username": "test1122",<br/>"password": "Test12345",<br/>} | {<br/>"msg": "회원가입 완료",<br/>"statusCode": 200<br/>}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | |
|    로그인    | /api/login | POST   |                                                                                                                                                                                                              | {<br/>"username": "test1122",<br/>"password": "Test12345"<br/>}  | {<br/>"msg": "로그인 성공",<br/>"statusCode": 200<br/>}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |Authorization:<br/>Bearer eyJhbGciOiJIUzI1NiJ9<br/>.eyJzdWIiOiJ0amd1cnRuMSIsImF1<br/>dGgiOiJVU0VSIiwiZXhwIjoxNjcwND<br/>g0OTk0LCJpYXQiOjE2NzA0ODEzO<br/>TR9.xwyHOpdM2Zgld1tJHGmrtVvJj<br/>JRWcOF6OJM9j_f57WE|
|  게시글 작성   | /api/boards | POST   | Authorization:<br/>Bearer eyJhbGciOiJIUzI1NiJ9<br/>.eyJzdWIiOiJ0amd1cnRuMSIsImF1<br/>dGgiOiJVU0VSIiwiZXhwIjoxNjcwND<br/>g0OTk0LCJpYXQiOjE2NzA0ODEzO<br/>TR9.xwyHOpdM2Zgld1tJHGmrtVvJj<br/>JRWcOF6OJM9j_f57WE | {<br/>"boardName": "글 제목",<br/>"contents": "글 내용"<br/>}          | {<br/>"createdAt": "2022-12-08T15:49:11.5919215",<br/>"modifiedAt": "2022-12-08T15:49:11.5919215",<br/>"id": 1,<br/>"boardName": "글 제목",<br/>"username": "test1122",<br/>"contents": "글 내용"<br/>}                                                                                                                                                                                                                                                                                                                                                                                                             |
| 게시글 목록 조회 | /api/boards | POST   |                                                                                                                                                                                                              |                                                                  | {<br/>"createdAt": "2022-12-08T15:49:11.5919215",<br/>"modifiedAt": "2022-12-08T15:49:11.5919215",<br/>"id": 1,<br/>"boardName": "글 제목",<br/>"username": "test1122",<br/>"contents": "글 내용"<br/>}<br/>{<br/>"createdAt": "2022-12-08T15:49:11.5919215",<br/>"modifiedAt": "2022-12-08T15:49:11.5919215",<br/>"id": 2,<br/>"boardName": "글 제목",<br/>"username": "test1122",<br/>"contents": "글 내용"<br/>}<br/>{<br/>"createdAt": "2022-12-08T15:49:11.5919215",<br/>"modifiedAt": "2022-12-08T15:49:11.5919215",<br/>"id": 3,<br/>"boardName": "글 제목",<br/>"username": "test2233",<br/>"contents": "글 내용"<br/>} |
|  게시글 수정   | /api/boards | PUT    | Authorization:<br/>Bearer eyJhbGciOiJIUzI1NiJ9<br/>.eyJzdWIiOiJ0amd1cnRuMSIsImF1<br/>dGgiOiJVU0VSIiwiZXhwIjoxNjcwND<br/>g0OTk0LCJpYXQiOjE2NzA0ODEzO<br/>TR9.xwyHOpdM2Zgld1tJHGmrtVvJj<br/>JRWcOF6OJM9j_f57WE | {<br/>"boardName": "제목 수정",<br/>"contents": "내용 수정"<br/>}        | {<br/>"createdAt": "2022-12-08T15:49:11.5919215",<br/>"modifiedAt": "2022-12-08T15:49:11.5919215",<br/>"id": 1,<br/>"boardName": "제목 수정",<br/>"username": "test1122",<br/>"contents": "내용 수정"<br/>}                                                                                                                                                                                                                                                                                                                                                                                                           |
|  게시글 수정   | /api/boards | DELETE | Authorization:<br/>Bearer eyJhbGciOiJIUzI1NiJ9<br/>.eyJzdWIiOiJ0amd1cnRuMSIsImF1<br/>dGgiOiJVU0VSIiwiZXhwIjoxNjcwND<br/>g0OTk0LCJpYXQiOjE2NzA0ODEzO<br/>TR9.xwyHOpdM2Zgld1tJHGmrtVvJj<br/>JRWcOF6OJM9j_f57WE |                                                                  | {<br/>"createdAt": "2022-12-08T15:49:11.5919215",<br/>"modifiedAt": "2022-12-08T15:49:11.5919215",<br/>"id": 1,<br/>"boardName": "제목 수정",<br/>"username": "test1122",<br/>"contents": "내용 수정"<br/>}                                                                                                                                                                                                                                                                                                                                                                                                           |


<br/>
<br/>

## 과제 제출관련 답변


---


<details>
<summary>3주차 과제 답변</summary>
<div markdown="1">       

**1. 수정, 삭제 API의 request를 어떤 방식으로 사용하셨나요? (param, query, body) <br/>**
> 수정시에는 `@PathVariable` 으로 `id` 값을 가져와서 "localhost:8080/api/board/1" 이렇게 `url` 링크로 접근해서
> 마지막 뒤에 붙은 값을 기준으로 삭제 및 업데이트에서 파라미터로 이용해서 사용했다. <br/>
> 그리고 나서 `requestDto로` 비밀번호 값만을 가져와서 입력하여 삭제하는데 `@RequestBody` 를 사용했다. <br/>
> 이 때에는 `JSON` 형태로 또 입력된 값 그 자체를 가져오기 위해서 사용하였으며 이를 이용해 비밀번호 값을 가져와서
> 비교하는데 사용했다.


**2. 어떤 상황에 어떤 방식의 request를 써야하나요? <br/>**
> ● @PathVariable <br/>
> 우선 이번처럼 `uri` 경로의 일부를 파라미터로 이용하는 방법을 통해 내가 원하는 게시글을 찾거나 또는 상품페이지 같은 경우를 <br/>
> 찾고 또 수정하고 하는데 있어서 매우 유용한것 같아서 이러한 상황에서 `@PathVariable` 이 매우 유용한 것 같다. <br/>
https://u0hun.tistory.com/21 이런 식으로 글마다 `@PathVariable` 를 사용해서 주소로 활용하는것 같다. <br/>
> ● @RequestParam <br/>
> GET 방식으로 넘어오는 경우에 용이한데 그 예로 들자면 https://newsstand.naver.com/?list=&pcode=422 <br/>
> 위 링크 처럼 주소 뒤에 `key` 와 `value` 받는 모습처럼 기능한다. 이 또한 사이트 주소별로 구분짓기에 매우 용이하다.
> 즉, `uri` 의 뒤에 부튼 파라미터의 값을 가져오는 방식이다. <br/>
> ● @RequestBody <br/>
> 이런식의 경우에는 객체를 반환해주기 때문에 `response` 로 받아올 때 `JSON` 객체로 받아오기에 유용하다. <br/>
> 다른 기존의 방식들처럼 통째로 넘기기 보다는 딱 필요한 부분의 데이터만을 넘기기 때문에 지금처럼 게시판에서
> 삭제 및 수정에서 비밀번호의 값만을 `JSON` 객체로 사용하기에 이런 상황에 유용하다.

**3. RESTful한 API를 설계했나요? 어떤 부분이 그런가요? 어떤 부분이 그렇지 않나요? <br/>**
> 어느정도 그렇게 했다고 생각합니다. <br/>
> 게시판의 글을 업로드, 삭제, 수정, 긁어오기 등... `REST API` 를 말하는 핵심요소인 `CRUD` 에 있어서 필요한 기능은 기본적으로 다 구현했기 때문에 `Restfull` 하게 설계했다고 생각합니다. <br/>
> 하지만 아직 `DTO` 를 세세하게 나누고 메소드명만을 보고 바로바로 이 기능에 대해 이해하는 부분에 있어서 즉, 메소드명을 잘 만드는 부분에 있어서 좀 부족하다고 생각합니다.


**4. 적절한 관심사 분리를 적용하였나요? (Controller, Repository, Service) <br/>**
> ● Controller <br/>
> 클라이언트의 요청을 받아서 `service로` 날려보내서 중간다리 역할을 하는 부분 <br/>
> 즉, 게시판에서 `CRUD` 에 관련한 기능들을 수행하기 요청과 응답을 날려주는 부분으로서만의 기능을 하게 구현했다고 생각합니다. <br/>
> ● Service <br/>
> 흔히들 말하는 "비즈니스 로직" 을 실행하는 부분으로 이번 게시판에서는 값을 `Repo` 에서 가져오고 그것을 `Dto` 에 넣으며, <br/>
> 그 과정에서 `DB` 에 접근 및 중간에서 생기는 예외 사항들에 대한 부분들을 처리하는등 서비스의 역할을 잘 적용했다고 생각합니다. <br/>
> ● Repository <br/>
> 엔티티에 의해 생성된 게시판 자료들을 접근하기 위한 코드가 들어가 있다. <br/>
> 이를 이용해서 `board` 의 정보를 긁어와서 담는것이 가능해지기 때문에 일반적으로 `DB` 접근 관려 코드가 모인 장소로서의 기능을
> 비슷하게나마 사용하였다고 생각합니다.

</div>
</details>

<details>
<summary>4주차 과제1 답변</summary>
<div markdown="1">       

1. 처음 설계한 API 명세서에 변경사항이 있었나요? 변경 되었다면 어떤 점 때문 일까요? 첫 설계의 중요성에 대해 작성해 주세요!

>API 명세서에서 변경은 없었으나 API 명세서를 잘 읽지 않고 진행하게 되어서 계속해서 중간중간 파일이 추가되었던게 아쉬웠습니다.  
>그래서 처음 설계시 잘 만들어진 것을 참고로 하면 중간과정에서 쓸데없는 코드가 줄고 개발시간 단축의 효과가 있을 거 같습니다.

2. ERD를 먼저 설계한 후 Entity를 개발했을 때 어떤 점이 도움이 되셨나요?

>ERD 라는 것을 처음 알아서 시작전에 제대로 구상하지 못하고 시작했던 것 같습니다.  
>다만 이를 통해서 내가 어떠한 엔티티 값을 필요로 하는지를 미리 인지하고 작성이 가능해지면  
>엔티티에 쓸모없는 값이 들어갔다가 삭제되고 하는 그러한 쓸데없는 과정이 줄 것 같습니다.

3. JWT를 사용하여 인증/인가를 구현 했을 때의 장점은 무엇일까요?

>- 사용자 인증에 필요한 모든 정보는 토큰 자체에 포함하기 때문에 별도의 인증 저장소가 필요 없습니다.
>- 그래서 인증 서버와 DB에 의존하지 않아도 된다.
>- 쿠키를 전달하지 않아도 되므로 쿠키를 사용함으로써 발생하는 취약점이 사라진다.
>- 파기시간(만기) 이 내장되어 있다.
>- 트래픽에 대한 부담이 적다.


4. 반대로 JWT를 사용한 인증/인가의 한계점은 무엇일까요?

>- 토큰 자체에 정보를 담고 있으므로 이를 탈취당했을 때 매우 위험한 약점이 존재한다.
>- 토큰의 페이로드에 3종류의 claim 을 저장하기 때문에 정보가 많아질수록 토큰의 길이가 늘어나 네트워크에 부하를 줄 수 있다.
>- 페이로드 자체는 암호화가 된것이 아니라, BASE64 로 인코딩 된 것이다. 그래서, 중간에 탈취하여 디코딩 시 데이터를 볼 수 있으므로,<br/>JWE 로 암호화 하거나 페이로드에 중요 데이터를 넣지 말아야 한다.

5. 만약 댓글 기능이 있는 블로그에서 댓글이 달려있는 게시글을 삭제하려고 한다면 무슨 문제가 발생할까요? Database 테이블 관점에서 해결방법이 무엇일까요?

>해당되는 글에 달려있는 댓글 및 답글 그리고 좋아요 싫어요 같은 관련된 정보들이 다 삭제되어야 한다.  
>DB 관점에서는 게시글 테이블과 댓글 테이블이 서로 다른 테이블인데 외래 키 를 통해서 서로간의 정보를 주고 받기 때문에  
>삭제할 때 이와 연관된 모든 정보를 삭제해야 한다.  
>ON DELETE CASCADE 이는 부모 테이블의 row 에 delete 또는 update 명령어를 적용할 때,  
>자동적으로 자식 테이블의 매치되는 row 에도 똑같이 반영하는 역할을 한다.  
>이를 위해서 외래키 옵션에 ON DELETE CASCADE 를 설정해 주어야 한다.

6. IoC / DI 에 대해 간략하게 설명해 주세요!

>의존성 주입을 하게 되면 예를 들어 Controller 에다가 Service 를 주입했다가 가정하자.  
>이렇게 되면 Controller 외부에서 객체를 생성해서 해당 객체를 클래스 내부에 주입해서 사용이 가능하다.  
>그러면 원래는 제어권한이 컨트롤러에 있으나 이경우에는 Controller 이 아니라 IOC-Container 가 가지게 된다.  
>그래서 이를 제어의 역전(IOC) 라고 부른다.

</div>
</details>

<br/>

-----
